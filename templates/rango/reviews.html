{% extends 'rango/base.html' %}
{% load staticfiles %}

{% block body_block %}
<h1 class="text-center">Most Popular Movie Reviews</h1>
{% if review_page %}
{% for review in review_page %}
<div class="container review">
    <div class="review-item">
        <div class="d-flex">
            <div class="film">
                <img class="" src="{{ MEDIA_URL}}movie_covers/{{review.movie.imdb_id }}.jpg" alt="movie cover">
            </div>
            <div class="short-content pl-4">
                <h5 >
                    <i class="fa fa-user"></i>
                    <span class="cr1">{{review.user}}</span>

                    <span class="ml-3 film-source">&nbsp{{ review.rating }}</span>
                    <span class="ml-3 time">{{review.time}}</span>
                </h5>
                <h4 class="cr1">{{review.title}}</h4>
                <div class="more">
                    <div class="text-wrap">
                        <div class="text">
                            {{review.content}}
                        </div>
                        <div class="util">
                            <a class="unfold" href="#">(More)</a>
                            <a class="put" href="#">(Less)</a>
                        </div>
                    </div>
                    <div class="response">
                        <!-- <a href="#"> <i class="fa fa-caret-down"></i>  666</a> -->
                        <!-- <a href="#"> <i class="fa fa-caret-up"></i> 888</a> -->
                        <a class="fabulous" href="#">
                            <i class="fa fa-thumbs-o-up"></i>
                            <!-- {{review.likes}} -->
                            <span>{{review.likes}}</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

    </div>
    

{% endfor %}
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    // Traverse all list items of the movie
    Array.from($('.review .more .text-wrap')).forEach(ele => {
            // whether hide
            if (ele.offsetHeight >= 200) {
                $(ele).addClass('maxHeight')
            } else {
                $(ele).children('.util').hide()
            }
        })
        $('.unfold').on('click', e => {
            $(e.target).parents('.text-wrap').removeClass('maxHeight').end().hide().siblings().show()
        })
        $('.put').on('click', e => {

            $(e.target).parents('.text-wrap').addClass('maxHeight').end().hide().siblings().show()
        })
        $('.fabulous').on('click', function (e) {
            e.preventDefault()
            $(this).children('span').html(Number($(this).children('span').text()) + 1)
        })
</script> 

<nav aria-label="Page navigation">
  <ul class="pagination justify-content-end">
    {% if review_page.has_previous %}
      <li class="page-item">
        <a class="page-link" href="{{ url_prefix }}{{ current_page|add:-1 }}">Previous</a>
      </li>
    {% else %}
      <li class="page-item disabled">
        <a class="page-link" href="#" aria-disabled="true">Previous</a>
      </li>
    {% endif %}

    {% for i in page_range %}
      {% if i == current_page %}
        <li class="page-item  active"><a class="page-link" href="#">{{ i }}</a></li>
      {% else %}
        <li class="page-item"><a class="page-link" href="{{ url_prefix }}{{ i }}">{{ i }}</a></li>
      {% endif %}
    {% endfor %}

    {% if review_page.has_next %}
      <li class="page-item">
        <a class="page-link" href="{{ url_prefix }}{{ current_page|add:1 }}">Next</a>
      </li>
    {% else %}
      <li class="page-item disabled">
        <a class="page-link" aria-disabled="true" href="#">Next</a>
      </li>
    {% endif %}
  </ul>
</nav>

{% else %}
<strong>No reviews</strong>
{% endif %}

</div>
{% endblock %}